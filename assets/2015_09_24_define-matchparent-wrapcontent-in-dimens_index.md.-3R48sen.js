import{_ as i,a,o as n,X as t}from"./chunks/framework.Cp7KI1mb.js";const c=JSON.parse('{"title":"(Android) dimens.xmlでmatch_parent/wrap_contentを定義する","description":"","frontmatter":{"layout":"post","title":"(Android) dimens.xmlでmatch_parent/wrap_contentを定義する","category":"programming","tags":["Android"],"head":[["link",{"rel":"canonical","href":"https://www.codingfeline.com/2015/09/24/define-matchparent-wrapcontent-in-dimens/"}],["meta",{"property":"og:url","content":"https://www.codingfeline.com/2015/09/24/define-matchparent-wrapcontent-in-dimens/"}],["meta",{"property":"og:title","content":"(Android) dimens.xmlでmatch_parent/wrap_contentを定義する"}],["meta",{"property":"twitter:card","content":"summary_large_image"}],["meta",{"property":"twitter:site","content":"@_yshrsmz"}],["meta",{"property":"twitter:creator","content":"@_yshrsmz"}],["meta",{"property":"og:image","content":"https://www.codingfeline.com/2015/09/24/define-matchparent-wrapcontent-in-dimens/ogp.png"}]]},"headers":[],"relativePath":"2015/09/24/define-matchparent-wrapcontent-in-dimens/index.md","filePath":"posts/2015/2015-09-24-define-matchparent-wrapcontent-in-dimens.md","date":{"time":"2015-09-24","string":"September 24, 2015","year":"2015","month":"09","day":"24"}}'),e={name:"2015/09/24/define-matchparent-wrapcontent-in-dimens/index.md"};function p(l,s,h,r,k,d){return n(),a("div",null,[...s[0]||(s[0]=[t(`<p>例えば、画面サイズや画面の向きによってレイアウトの幅や高さを変えたい時なんかに</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>// value/dimens.xml</span></span>
<span class="line"><span>&lt;dimen name=&quot;container_width&quot;&gt;match_parent&lt;/dimen&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//value-land/dimens.xml</span></span>
<span class="line"><span>&lt;dimen name=&quot;container_width&quot;&gt;400dp&lt;/dimen&gt;</span></span></code></pre></div><p>などど設定できるとレイアウトxmlを2つ用意する必要がないので非常にはかどります。</p><p>しかし <code>match_parent</code> は文字列なので、上記のコードはもちろん使えません。エラーになります。</p><p><code>ViewGroup$LayoutParams</code> を見てみると、<code>match_parent</code>, <code>wrap_content</code> は下記の用に定義されています。</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * Special value for the height or width requested by a View.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * MATCH_PARENT means that the view wants to be as big as its parent,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * minus the parent&#39;s padding, if any. Introduced in API Level 8.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> final</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MATCH_PARENT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * Special value for the height or width requested by a View.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * WRAP_CONTENT means that the view wants to be just large enough to fit</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * its own internal content, taking its own padding into account.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> final</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> WRAP_CONTENT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>この値をdimens.xmlに書けば <code>match_parent</code> や <code>wrap_content</code> が使える−−、とはいかないようです。</p><p><a href="http://stackoverflow.com/questions/6859331/how-can-i-use-layout-width-using-resource-file#answer-19461468" target="_blank" rel="noreferrer">こちらのStackOverflow</a>によると、 <code>TypedValue#complexToDimensionPixelSize()</code> は負数の扱いを考慮していないようで、普通に <code>wrap_content</code> の値である <code>-2px</code> を書くと <code>-1</code> になってしまうようです。</p><p>この現象を回避するため、最終的なdimens.xmlは下記のようになります。</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">// value/dimens.xml</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">dimen</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;match_parent&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;-2px&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">dimen</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">&lt;!-- -1pxでもよい --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">dimen</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;wrap_content&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;-3px&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">dimen</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">dimen</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;container_width&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;@dimen/match_parent&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">dimen</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">//value-land/dimens.xml</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">dimen</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;container_width&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;400dp&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">dimen</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>こちらからは以上です。</p><h2 id="参考リンク" tabindex="-1">参考リンク <a class="header-anchor" href="#参考リンク" aria-label="Permalink to &quot;参考リンク&quot;">​</a></h2><ul><li><a href="http://stackoverflow.com/questions/6859331/how-can-i-use-layout-width-using-resource-file" target="_blank" rel="noreferrer">How can I use layout_width using resource file?</a></li><li><a href="https://code.google.com/p/android/issues/detail?id=61222&amp;thanks=61222&amp;ts=1382148635" target="_blank" rel="noreferrer">Issue 61222: TypedValue#complexToDimensionPixelSize() rounds negative dimensions incorrectly</a></li></ul>`,13)])])}const g=i(e,[["render",p]]);export{c as __pageData,g as default};
