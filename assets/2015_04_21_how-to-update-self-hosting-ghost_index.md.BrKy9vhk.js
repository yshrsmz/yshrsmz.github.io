import{_ as i,o as a,a as t,X as h}from"./chunks/framework.BPPv2K3c.js";const g=JSON.parse('{"title":"(Ghost) セルフホスティングなGhostをアップデートする","description":"","frontmatter":{"layout":"post","title":"(Ghost) セルフホスティングなGhostをアップデートする","category":"programming","tags":["ghost"],"head":[["link",{"rel":"canonical","href":"https://www.codingfeline.com/2015/04/21/how-to-update-self-hosting-ghost/"}],["meta",{"property":"og:url","content":"https://www.codingfeline.com/2015/04/21/how-to-update-self-hosting-ghost/"}],["meta",{"property":"og:title","content":"(Ghost) セルフホスティングなGhostをアップデートする"}],["meta",{"property":"twitter:card","content":"summary_large_image"}],["meta",{"property":"twitter:site","content":"@_yshrsmz"}],["meta",{"property":"twitter:creator","content":"@_yshrsmz"}],["meta",{"property":"og:image","content":"https://www.codingfeline.com/2015/04/21/how-to-update-self-hosting-ghost/ogp.png"}]]},"headers":[],"relativePath":"2015/04/21/how-to-update-self-hosting-ghost/index.md","filePath":"posts/2015/2015-04-21-how-to-update-self-hosting-ghost.md","date":{"time":"2015-04-21","string":"April 21, 2015","year":"2015","month":"04","day":"21"}}'),e={name:"2015/04/21/how-to-update-self-hosting-ghost/index.md"};function l(n,s,p,o,r,k){return a(),t("div",null,[...s[0]||(s[0]=[h(`<p>Ghostは月一回前後のスパンでアップデートをリリースしています。<br> 新しい機能やBugfix、脆弱性対応を取り入れるためにはできる限り頻繁にアップデートを反映していきたいものです。</p><p>今回はその手順を簡単に。</p><ol><li>新しいGhostのzipをダウンロードする</li><li>作業フォルダに展開する</li><li>インストール済みのGhostからアップデート関連のファイルを削除する</li><li>削除したファイルを作業フォルダに展開したアップデート用ファイルからコピーする</li><li>テーマの更新</li><li>依存ライブラリの更新</li><li>パーミッションの更新</li><li>Ghostの再起動</li></ol><h3 id="_1-新しいghostのzipをダウンロードする" tabindex="-1">1. 新しいGhostのzipをダウンロードする <a class="header-anchor" href="#_1-新しいghostのzipをダウンロードする" aria-label="Permalink to &quot;1. 新しいGhostのzipをダウンロードする&quot;">​</a></h3><p><a href="https://ghost.org/download/" target="_blank" rel="noreferrer">https://ghost.org/download/</a> から最新のzipのURLを取得します。<br> ちなみに、 <a href="https://ghost.org/zip/ghost-latest.zip" target="_blank" rel="noreferrer">https://ghost.org/zip/ghost-latest.zip</a> このURLで最新版がとれるみたいです。</p><p>URLがわかったら、適当な作業ディレクトリにダウンロードします。<br> 今回は<code>~/tmp/</code>にダウンロードします。</p><p>※ここでrootとかghost管理用ユーザとか、適切なアカウントに切り替えるのを忘れないように</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -L</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://ghost.org/zip/ghost-latest.zip</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/tmp/ghost.zip</span></span></code></pre></div><h3 id="_2-作業フォルダに展開する" tabindex="-1">2. 作業フォルダに展開する <a class="header-anchor" href="#_2-作業フォルダに展開する" aria-label="Permalink to &quot;2. 作業フォルダに展開する&quot;">​</a></h3><p>ダウンロードしてきたzipファイルを解凍します。<br> zipと同じ<code>~/tmp/</code>に展開します。</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> unzip</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -uo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/tmp/ghost.zip</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/tmp/ghost</span></span></code></pre></div><h3 id="_3-インストール済みのghostからアップデート関連のファイルを削除する" tabindex="-1">3. インストール済みのGhostからアップデート関連のファイルを削除する <a class="header-anchor" href="#_3-インストール済みのghostからアップデート関連のファイルを削除する" aria-label="Permalink to &quot;3. インストール済みのGhostからアップデート関連のファイルを削除する&quot;">​</a></h3><p>Ghostインストールディレクトリから、下記のファイル・ディレクトリを削除します</p><ul><li>index.js</li><li>package.json</li><li>npm-shrinkwrap.json</li><li>core/</li></ul><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /your/ghost/dir</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> index.js</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> package.json</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> npm-shrinkwrap.json</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -rf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> core/</span></span></code></pre></div><h3 id="_4-削除したファイルを作業フォルダに展開したアップデート用ファイルからコピーする" tabindex="-1">4. 削除したファイルを作業フォルダに展開したアップデート用ファイルからコピーする <a class="header-anchor" href="#_4-削除したファイルを作業フォルダに展開したアップデート用ファイルからコピーする" aria-label="Permalink to &quot;4. 削除したファイルを作業フォルダに展開したアップデート用ファイルからコピーする&quot;">​</a></h3><p><code>~/tmp/ghost</code>から、先ほど削除したファイル・ディレクトリと同名のものをコピーしてきます。</p><ul><li>index.js</li><li>package.json</li><li>npm-shrinkwrap.json</li><li>core/</li></ul><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /your/ghost/dir</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/tmp/ghost/index.js</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> index.js</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/tmp/ghost/package.json</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> package.json</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/tmp/ghost/npm-shrinkwrap.json</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> npm-shrinkwrap.json</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/tmp/ghost/core/</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> core/</span></span></code></pre></div><h3 id="_5-テーマの更新" tabindex="-1">5. テーマの更新 <a class="header-anchor" href="#_5-テーマの更新" aria-label="Permalink to &quot;5. テーマの更新&quot;">​</a></h3><p>このタイミングで、必要であればテーマも更新しておきます。<br> 標準のCasperを使ってるのであれば、上記の要領で<code>content/themes/casper/</code>を削除＆コピーしてきましょう。</p><h3 id="_6-依存ライブラリの更新" tabindex="-1">6. 依存ライブラリの更新 <a class="header-anchor" href="#_6-依存ライブラリの更新" aria-label="Permalink to &quot;6. 依存ライブラリの更新&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /your/ghost/dir</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --production</span></span></code></pre></div><h3 id="_7-パーミッションの更新" tabindex="-1">7. パーミッションの更新 <a class="header-anchor" href="#_7-パーミッションの更新" aria-label="Permalink to &quot;7. パーミッションの更新&quot;">​</a></h3><p>ghost管理ユーザで作業してる場合は大丈夫ですが、違うユーザ使ってる場合はghostユーザに所有者変えときましょう</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> chown</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -R</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ghost:ghost</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /your/ghost/dir</span></span></code></pre></div><h2 id="_8-ghostの再起動" tabindex="-1">8. Ghostの再起動 <a class="header-anchor" href="#_8-ghostの再起動" aria-label="Permalink to &quot;8. Ghostの再起動&quot;">​</a></h2><p>再起動します。<br> daemon化の方法によっていろいろだと思うので各自いい感じにお願いします<br> initスクリプト使ってる場合は</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/init.d/ghost</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span></span></code></pre></div><p>とか</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> service</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ghost</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span></span></code></pre></div><p>とかそんな感じで。</p><p>以上です。<br> この作業もAnsibleで自動化しておくと捗りそうですね。</p><p>参考: <a href="http://support.ghost.org/how-to-upgrade/" target="_blank" rel="noreferrer">How to upgrade self-installed Ghost</a></p>`,34)])])}const F=i(e,[["render",l]]);export{g as __pageData,F as default};
