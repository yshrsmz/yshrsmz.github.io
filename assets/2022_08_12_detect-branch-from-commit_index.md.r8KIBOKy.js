import{_ as t,o as a,a as s,X as n}from"./chunks/framework.BPPv2K3c.js";const g=JSON.parse('{"title":"Git の コミットハッシュからブランチ名を取得する","description":"","frontmatter":{"layout":"post","title":"Git の コミットハッシュからブランチ名を取得する","category":"programming","tags":["Git","TIL"],"head":[["link",{"rel":"canonical","href":"https://www.codingfeline.com/2022/08/12/detect-branch-from-commit/"}],["meta",{"property":"og:url","content":"https://www.codingfeline.com/2022/08/12/detect-branch-from-commit/"}],["meta",{"property":"og:title","content":"Git の コミットハッシュからブランチ名を取得する"}],["meta",{"property":"twitter:card","content":"summary_large_image"}],["meta",{"property":"twitter:site","content":"@_yshrsmz"}],["meta",{"property":"twitter:creator","content":"@_yshrsmz"}],["meta",{"property":"og:image","content":"https://www.codingfeline.com/2022/08/12/detect-branch-from-commit/ogp.png"}]]},"headers":[],"relativePath":"2022/08/12/detect-branch-from-commit/index.md","filePath":"posts/2022/2022-08-12-detect-branch-from-commit.md","date":{"time":"2022-08-12","string":"August 12, 2022","year":"2022","month":"08","day":"12"}}'),o={name:"2022/08/12/detect-branch-from-commit/index.md"};function c(i,e,p,r,d,m){return a(),s("div",null,[...e[0]||(e[0]=[n('<p>CI は基本的に detached HEAD で実行されるので、 reg-suit などブランチ上で実行されること前提なツールを使う場合は、どうにかしてブランチ名を取得してチェックアウトしなおす必要がある。</p><p>結論から言うと、<a href="https://git-scm.com/docs/git-name-rev" target="_blank" rel="noreferrer"><code>git name-rev</code></a> コマンドを使う。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ git name-rev 740e99b1d53c3276736ab6806027c980d1fef8c6</span></span></code></pre></div><p>などとコミットハッシュを与えて実行すると</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>740e99b1d53c3276736ab6806027c980d1fef8c6 feature/awesome-feature</span></span></code></pre></div><p>という具合にブランチ名が取得できる。ブランチ名だけでよければ <code>--name-only</code> を追加して</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ git name-rev --name-only 740e99b1d53c3276736ab6806027c980d1fef8c6</span></span></code></pre></div><p>と実行する。</p><p>ただこれ、一つ盲点がある。同じコミットハッシュに <strong>タグ</strong> と <strong>ブランチ</strong> が両方存在すると、タグが返ってきてしまう。</p><p>対策は簡単で、 <code>--refs</code> オプションを利用してブランチ名のみ取得するようなパターンを与えてあげればよい</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ git name-rev --name-only --refs=&quot;refs/heads/*&quot; 740e99b1d53c3276736ab6806027c980d1fef8c6</span></span></code></pre></div><p>こんな感じ。</p>',12)])])}const h=t(o,[["render",c]]);export{g as __pageData,h as default};
