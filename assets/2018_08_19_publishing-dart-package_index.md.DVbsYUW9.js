import{_ as s,o as n,a as p,X as e}from"./chunks/framework.BPPv2K3c.js";const u=JSON.parse('{"title":"DartのPackage(ライブラリ)を公開する","description":"","frontmatter":{"layout":"post","title":"DartのPackage(ライブラリ)を公開する","category":"programming","tags":["Dart"],"head":[["link",{"rel":"canonical","href":"https://www.codingfeline.com/2018/08/19/publishing-dart-package/"}],["meta",{"property":"og:url","content":"https://www.codingfeline.com/2018/08/19/publishing-dart-package/"}],["meta",{"property":"og:title","content":"DartのPackage(ライブラリ)を公開する"}],["meta",{"property":"twitter:card","content":"summary_large_image"}],["meta",{"property":"twitter:site","content":"@_yshrsmz"}],["meta",{"property":"twitter:creator","content":"@_yshrsmz"}],["meta",{"property":"og:image","content":"https://www.codingfeline.com/2018/08/19/publishing-dart-package/ogp.png"}]]},"headers":[],"relativePath":"2018/08/19/publishing-dart-package/index.md","filePath":"posts/2018/2018-08-19-publishing-dart-package.md","date":{"time":"2018-08-19","string":"August 19, 2018","year":"2018","month":"08","day":"19"}}'),t={name:"2018/08/19/publishing-dart-package/index.md"};function l(i,a,r,c,o,d){return n(),p("div",null,[...a[0]||(a[0]=[e(`<p><a href="https://pub.dartlang.org/packages/unorm_dart" target="_blank" rel="noreferrer">unorm_dart</a>というDartのPackageを公開したので公開周りのフローをまとめます。</p><p><code>pub publish --dry-run</code> を実行するといい感じにいろいろ教えてくれます。たとえばこんな感じ。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Publishing unorm_dart 0.1.0 to https://pub.dartlang.org:</span></span>
<span class="line"><span>|-- .gitignore</span></span>
<span class="line"><span>|-- .idea</span></span>
<span class="line"><span>|   |-- codeStyles</span></span>
<span class="line"><span>|   |   |-- Project.xml</span></span>
<span class="line"><span>|   |   &#39;-- codeStyleConfig.xml</span></span>
<span class="line"><span>|   &#39;-- saveactions_settings.xml</span></span>
<span class="line"><span>|-- CHANGELOG.md</span></span>
<span class="line"><span>|-- LICENSE</span></span>
<span class="line"><span>|-- README.md</span></span>
<span class="line"><span>|-- analysis_options.yaml</span></span>
<span class="line"><span>|-- example</span></span>
<span class="line"><span>|   &#39;-- unorm_dart_example.dart</span></span>
<span class="line"><span>|-- lib</span></span>
<span class="line"><span>|   |-- src</span></span>
<span class="line"><span>|   |   |-- composite_iterator.dart</span></span>
<span class="line"><span>|   |   |-- decomposite_iterator.dart</span></span>
<span class="line"><span>|   |   |-- iterator.dart</span></span>
<span class="line"><span>|   |   |-- recursive_decomposite_iterator.dart</span></span>
<span class="line"><span>|   |   |-- uchar.dart</span></span>
<span class="line"><span>|   |   |-- uchar_iterator.dart</span></span>
<span class="line"><span>|   |   |-- unorm_dart_base.dart</span></span>
<span class="line"><span>|   |   |-- unormdata.dart</span></span>
<span class="line"><span>|   |   &#39;-- utils.dart</span></span>
<span class="line"><span>|   &#39;-- unorm_dart.dart</span></span>
<span class="line"><span>|-- pubspec.yaml</span></span>
<span class="line"><span>&#39;-- test</span></span>
<span class="line"><span>    |-- normalization_test.dart</span></span>
<span class="line"><span>    &#39;-- unorm_dart_test.dart</span></span>
<span class="line"><span>Missing requirements:</span></span>
<span class="line"><span>* Your pubspec.yaml is missing a &quot;homepage&quot; field.</span></span>
<span class="line"><span>Sorry, your package is missing a requirement and can&#39;t be published yet.</span></span>
<span class="line"><span>For more information, see: https://www.dartlang.org/tools/pub/cmd/pub-lish.</span></span></code></pre></div><p>表示される内容は以下の通り</p><ul><li>公開するパッケージの名称、バージョン、公開先(基本的にpub.dartlang.orgのはず)</li><li>公開するパッケージに含まれるファイル</li><li>公開するために足りない要件</li></ul><p>一番最後の項目を潰していけば公開できるようになります。<br> 今回の場合だと、<code>pubspec.yaml</code>にhomepageフィールドが足りないようです。homepageフィールドを追加してもう一度 <code>pub publish --dry-run</code> すると下記のようになります。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Publishing unorm_dart 0.1.0 to https://pub.dartlang.org:</span></span>
<span class="line"><span>|-- .gitignore</span></span>
<span class="line"><span>|-- .idea</span></span>
<span class="line"><span>|   |-- codeStyles</span></span>
<span class="line"><span>|   |   |-- Project.xml</span></span>
<span class="line"><span>|   |   &#39;-- codeStyleConfig.xml</span></span>
<span class="line"><span>|   &#39;-- saveactions_settings.xml</span></span>
<span class="line"><span>|-- CHANGELOG.md</span></span>
<span class="line"><span>|-- LICENSE</span></span>
<span class="line"><span>|-- README.md</span></span>
<span class="line"><span>|-- analysis_options.yaml</span></span>
<span class="line"><span>|-- example</span></span>
<span class="line"><span>|   &#39;-- unorm_dart_example.dart</span></span>
<span class="line"><span>|-- lib</span></span>
<span class="line"><span>|   |-- src</span></span>
<span class="line"><span>|   |   |-- composite_iterator.dart</span></span>
<span class="line"><span>|   |   |-- decomposite_iterator.dart</span></span>
<span class="line"><span>|   |   |-- iterator.dart</span></span>
<span class="line"><span>|   |   |-- recursive_decomposite_iterator.dart</span></span>
<span class="line"><span>|   |   |-- uchar.dart</span></span>
<span class="line"><span>|   |   |-- uchar_iterator.dart</span></span>
<span class="line"><span>|   |   |-- unorm_dart_base.dart</span></span>
<span class="line"><span>|   |   |-- unormdata.dart</span></span>
<span class="line"><span>|   |   &#39;-- utils.dart</span></span>
<span class="line"><span>|   &#39;-- unorm_dart.dart</span></span>
<span class="line"><span>|-- pubspec.yaml</span></span>
<span class="line"><span>&#39;-- test</span></span>
<span class="line"><span>    |-- normalization_test.dart</span></span>
<span class="line"><span>    &#39;-- unorm_dart_test.dart</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Package has 0 warnings.</span></span></code></pre></div><p>これで公開できるはずです。</p><p>また、このときPackageに入れたくないファイルが含まれていないか確認しましょう。Packageに含まれないファイルは下記の通りです。</p><ul><li><code>packages</code> ディレクトリ(Dart2系では使われていないはず)</li><li>このPackageのロックファイル(<code>pubspec.lock</code>)</li><li>Gitを使っていなければ、すべての隠しファイル(<code>.</code>から始まるファイル)</li><li>Gitを使っていれば、<code>.gitignore</code>に指定されているファイル</li></ul><p>つまり、基本的にGitで管理しているファイルはすべて公開されるパッケージに含まれます。公開されたくないものはレポジトリに入れないようにしましょう。<br> 今回の場合だと、本来IntelliJの設定フォルダである <code>.idea</code> はPackageに入れたくないのですが、コードスタイルの設定はレポジトリで共有したいのでやむなく含まれています。</p><p>用意ができたら <code>pub publish</code> で公開します。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Publishing unorm_dart 0.1.0 to https://pub.dartlang.org:</span></span>
<span class="line"><span>|-- .gitignore</span></span>
<span class="line"><span>|-- .idea</span></span>
<span class="line"><span>|   |-- codeStyles</span></span>
<span class="line"><span>|   |   |-- Project.xml</span></span>
<span class="line"><span>|   |   &#39;-- codeStyleConfig.xml</span></span>
<span class="line"><span>|   &#39;-- saveactions_settings.xml</span></span>
<span class="line"><span>|-- CHANGELOG.md</span></span>
<span class="line"><span>|-- LICENSE</span></span>
<span class="line"><span>|-- README.md</span></span>
<span class="line"><span>|-- analysis_options.yaml</span></span>
<span class="line"><span>|-- example</span></span>
<span class="line"><span>|   &#39;-- unorm_dart_example.dart</span></span>
<span class="line"><span>|-- lib</span></span>
<span class="line"><span>|   |-- src</span></span>
<span class="line"><span>|   |   |-- composite_iterator.dart</span></span>
<span class="line"><span>|   |   |-- decomposite_iterator.dart</span></span>
<span class="line"><span>|   |   |-- iterator.dart</span></span>
<span class="line"><span>|   |   |-- recursive_decomposite_iterator.dart</span></span>
<span class="line"><span>|   |   |-- uchar.dart</span></span>
<span class="line"><span>|   |   |-- uchar_iterator.dart</span></span>
<span class="line"><span>|   |   |-- unorm_dart_base.dart</span></span>
<span class="line"><span>|   |   |-- unormdata.dart</span></span>
<span class="line"><span>|   |   &#39;-- utils.dart</span></span>
<span class="line"><span>|   &#39;-- unorm_dart.dart</span></span>
<span class="line"><span>|-- pubspec.yaml</span></span>
<span class="line"><span>&#39;-- test</span></span>
<span class="line"><span>    |-- normalization_test.dart</span></span>
<span class="line"><span>    &#39;-- unorm_dart_test.dart</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Looks great! Are you ready to upload your package (y/n)?</span></span></code></pre></div><p><code>y</code> を入力</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Pub needs your authorization to upload packages on your behalf.</span></span>
<span class="line"><span>In a web browser, go to https://accounts.google.com/o/oauth2/auth?access_type=XXXXXXXXXXXXXX</span></span>
<span class="line"><span>Then click &quot;Allow access&quot;.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Waiting for your authorization...</span></span></code></pre></div><p>WebブラウザでアクセスするためのURLが表示されるので、ブラウザを開きます。Packageを公開するにはGoogleアカウントが必要で、そのための承認作業です。</p><p>無事アカウントの認証ができると、こんな画面が表示されます。ターミナルに戻ると公開処理が完了しているはずです。</p><p><img src="https://lh3.googleusercontent.com/fnNkbwhsAV9gfc2p8AdvDclZYGzWuCwIdkiBFI7-hjCusG45S6LWbmVS2dUxjHTImSDmW8aQ6Lzy8PZ-s_9G7tcRd3_ryL7cW_FtCvb00663yjliPfOfZ5OsvgvvvJhPx9Cd7ICxNLZI4Ygx8ciVrH-WUJtWcOZ9OU7H2cFFpqeSRyya9zEXdjRyALCdM1QFFBS6hS4AgIP4ZNHHhh9tnPHDXwQvaptRj2TqJTq85DG6jLJwy1TWHIP_zdKjxq7CwyZZftzQxwYbFQJB6kRnnc2quVPCMj136cMJwvdcmcNxwyizfoAbiCvsYDlTMp9GnsaSD6g8dzPot-aB54-I1LYWT1xAv5dT8s_aYXUBIQF2VwmxyRJf0_nXYkOFcWk1XF3IIpWbhL__Sse7IKbN204sflXXIi3MkwmYuo2mFmYjSrpts52E_CWNExrIhotZAKEZ9nkBtqpWnSaUM2cyl_Nv37W3iZNlI72yXVXIwDokU0D9caYgpOX6C5NQ69B1d7e15NcVpfZaU_Q24XYOP2Tj_EiSL-vEJbLaHDXX0wh2Dbhj2XGfmqBV34LgjJLH9gyM2CXvFKcACxMV_831O01qLrRFnBZnsDhHKiOylPGZQmAXOOxKRjnzdslKCFk73_qmBqDTh9cCCyTm3nHQpNPvPfGEO0Zo2unV7dZyRf38sPpXPdkz9g=w900" alt="authorized"></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Authorization received, processing...</span></span>
<span class="line"><span>Successfully authorized.</span></span>
<span class="line"><span>Uploading... (3.4s)</span></span>
<span class="line"><span>Successfully uploaded package.</span></span></code></pre></div><p>30分くらい？待つと <a href="https://pub.dartlang.org" target="_blank" rel="noreferrer">https://pub.dartlang.org</a> で検索に表示されるようになります。</p><hr><p>Dartのパッケージ公開、本当に楽でした。ほぼCLIで終わってしまうのはちょっと感動です。<br> 今までJavaのライブラリ開発をいくつかしていて、bintrayやmaven centralに公開したこともあるのですが、その時の作業とは比べものにならないほどのお手軽さでした。</p><p>今作ろうとしているサービスをFlutter/Dartで実現するためには必要なものがいくつもあるので、ちょこちょこコミュニティにPackageという形で貢献できたらなあ、と思います。</p><h3 id="参考" tabindex="-1">参考 <a class="header-anchor" href="#参考" aria-label="Permalink to &quot;参考&quot;">​</a></h3><ul><li><a href="https://www.dartlang.org/tools/pub/publishing" target="_blank" rel="noreferrer">Publishing a Package | Dart</a></li><li><a href="https://www.dartlang.org/tools/pub/pubspec" target="_blank" rel="noreferrer">Pubspec Format | Dart</a></li><li><a href="https://www.dartlang.org/tools/pub/package-layout" target="_blank" rel="noreferrer">Pub Package Layout Conventions | Dart</a></li></ul>`,25)])])}const m=s(t,[["render",l]]);export{u as __pageData,m as default};
